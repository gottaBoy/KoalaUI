<!DOCTYPE html>
<html lang="en" class="fuelux">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>KoalaUI测试</title>
<link href="../lib/fuelux/css/fuelux.css" rel="stylesheet">
<script src="../lib/require.js" type="text/javascript"></script>
<script src="../lib/jquery.js" type="text/javascript"></script>
<script>
requirejs.config({
	paths: {
		'jquery': '../lib/jquery',
		'underscore': 'http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min',
		'bootstrap': '../lib/bootstrap/js',
		'fuelux': '../lib/fuelux'
	}
});

require(['jquery','../lib/fuelux/all'], function ($) {

	$.post("../MenuServlet",null,function(data){
		// TREE
		var dataSourceTree = {
			data: eval(data),
			delay: 400
		};
	
		$('#ex-tree').tree({
			dataSource: dataSourceTree,
			loadingHTML: '<div class="static-loader">Loading...</div>',
			multiSelect: false,
			cacheItems: true
		});
	},"json");
	
	$("ul.nav-tabs li:first").on({
		click:function(){
			$(this).find("a:first").tab("show");
		}
	});
	
	$('#ex-tree').on('selected', function (e, info) {
		var tabName = info.info[0].title;
		var tabUrl = info.info[0].href;
		if(tabUrl == "#"){
			return;
		}
		var tabId = info.info[0].id;
		$(".tab-content div").removeClass("active");
		var navTabA = $("#"+tabId+tabUrl.split(".")[0]);
		if(navTabA.length == 0){
			addNewTab(tabUrl,tabName,tabId);
		}else{
			navTabA.parent().click();
		}
	});
	
	//添加新的tab
	function addNewTab(url,title,tabId){
		var li = $("<li><a href=\""+url.split(".")[0]+"\" data-toggle=\"tab\">"+title+"</a></li>");
		$("ul.nav-tabs").append(li); 
		var height = $(window).height()-$(".navbar").height()-$("ul.nav-tabs").height()-50;
		var div = $("<div class=\"tab-pane active\" id=\""+tabId+url.split(".")[0]+"\"><iframe src=\""+url+"\" style=\"height:"+height+"px;width:100%\"></iframe></div>");
		$(".tabbable").find(".tab-content").append(div);
		li.on({
			click:function(){
				$(".tab-content div").removeClass("active");
				div.addClass("active");
				li.find("a:first").tab("show");
			},
			dblclick:function(){
				li.prev("li").click();
				div.remove();
				li.remove();
			}
		});
		li.find("a:first").tab("show");
	};
	
	$('#MyGrid').datagrid({
		url: "../DataGridServlet"
	});
});

</script>
</head>
<body>
	<div class="navbar">
		<div class="navbar-inner">
			<div class="container-fluid">
				
				<!-- theme selector starts -->
				<div class="btn-group pull-right theme-container" >
					<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
						<i class="icon-tint"></i><span class="hidden-phone"> 切换皮肤</span>
						<span class="caret"></span>
					</a>
					<ul class="dropdown-menu" id="themes">
						<li><a data-value="classic" href="#"><i class="icon-blank"></i> Classic</a></li>
						<li><a data-value="cerulean" href="#"><i class="icon-blank"></i> Cerulean</a></li>
						<li><a data-value="cyborg" href="#"><i class="icon-blank"></i> Cyborg</a></li>
						<li><a data-value="redy" href="#"><i class="icon-blank"></i> Redy</a></li>
						<li><a data-value="journal" href="#"><i class="icon-blank"></i> Journal</a></li>
						<li><a data-value="simplex" href="#"><i class="icon-blank"></i> Simplex</a></li>
						<li><a data-value="slate" href="#"><i class="icon-blank"></i> Slate</a></li>
						<li><a data-value="spacelab" href="#"><i class="icon-blank"></i> Spacelab</a></li>
						<li><a data-value="united" href="#"><i class="icon-blank"></i> United</a></li>
					</ul>
				</div>
				<!-- theme selector ends -->
				
				<!-- user dropdown starts -->
				<div class="btn-group pull-right" >
					<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
						<i class="icon-user"></i><span class="hidden-phone">[Admin]欢迎你</span>
						<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="#">切换用户</a></li>
						<li class="divider"></li>
						<li><a href="login.html">注销</a></li>
					</ul>
				</div>
				<!-- user dropdown ends -->
				
				<div class="top-nav nav-collapse">
					<ul class="nav">
						<li><a href="#">KoalaUI</a></li>
					</ul>
				</div><!--/.nav-collapse -->
			</div>
		</div>
	</div>
	<div class="container-fluid">
		
		<div class="row-fluid">
			<!-- 左边树形菜单 -->
			<div class="span3">
				<div class="sidebar-menu">
					<div id="ex-tree" class="tree" style="height：350px；width:250px;">
						
					</div>
				</div>
				
			</div>
			
			<!-- 右边 -->
			<div class="span9">
				<div class="tabbable" id="tabs-156758">
					<ul class="nav nav-tabs">
						<li class="active">
							<a href="#panel-index" data-toggle="tab">主页</a>
						</li>
						
					</ul>
					<div class="tab-content" style="height:760px">
						<div class="tab-pane active" id="panel-index">
								<!-- DATAGRID -->
								<table id="MyGrid" class="table table-bordered datagrid">
							
									<thead>
									<tr>
										<th>
											<span class="datagrid-header-title">Geographic Data Sample</span>
							
											<div class="datagrid-header-left">
												<div class="input-append search datagrid-search">
													<input type="text" class="input-medium" placeholder="Search">
													<button class="btn"><i class="icon-search"></i></button>
												</div>
											</div>
											<div class="datagrid-header-right">
												<div class="select filter" data-resize="auto">
													<button data-toggle="dropdown" class="btn dropdown-toggle">
														<span class="dropdown-label"></span>
														<span class="caret"></span>
													</button>
													<ul class="dropdown-menu">
														<li data-value="all" data-selected="true"><a href="#">All</a></li>
														<li data-value="<=10000000"><a href="#">Population &lt;= 10000000</a></li>
														<li data-value=">=12000000"><a href="#">Population &gt;= 12000000</a></li>
													</ul>
												</div>
											</div>
										</th>
									</tr>
									</thead>
							
									<tfoot>
									<tr>
										<th>
											<div class="datagrid-footer-left" style="display:none;">
												<div class="grid-controls">
													<span>
														<span class="grid-start"></span> -
														<span class="grid-end"></span> of
														<span class="grid-count"></span>
													</span>
													<div class="select grid-pagesize" data-resize="auto">
														<button data-toggle="dropdown" class="btn dropdown-toggle">
															<span class="dropdown-label"></span>
															<span class="caret"></span>
														</button>
														<ul class="dropdown-menu">
															<li data-value="5" data-selected="true"><a href="#">5</a></li>
															<li data-value="10"><a href="#">10</a></li>
															<li data-value="20"><a href="#">20</a></li>
															<li data-value="50"><a href="#">50</a></li>
															<li data-value="100"><a href="#">100</a></li>
														</ul>
													</div>
													<span>Per Page</span>
												</div>
											</div>
											<div class="datagrid-footer-right" style="display:none;">
												<div class="grid-pager">
													<button type="button" class="btn grid-prevpage"><i class="icon-chevron-left"></i></button>
													<span>Page</span>
							
													<div class="input-append dropdown combobox" >
														<input class="dropdown-label" type="text" style="width:10px">
														<button class="btn" data-toggle="dropdown"><i class="caret"></i></button>
														<ul class="dropdown-menu"></ul>
													</div>
													<span>of <span class="grid-pages"></span></span>
													<button type="button" class="btn grid-nextpage"><i class="icon-chevron-right"></i></button>
												</div>
											</div>
										</th>
									</tr>
									</tfoot>
							
								</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>